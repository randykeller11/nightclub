{"ast":null,"code":"import _defineProperty from \"/Users/dub_ceo/Desktop/spacesvr-starter/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/dub_ceo/Desktop/spacesvr-starter/src/ideas/Builder12/layers/communication/visual/VisualInteraction/index.tsx\",\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nimport { useContext, useEffect, useMemo, useState } from \"react\";\nimport { useSpring, animated } from \"react-spring/three\";\nimport { Text } from \"@react-three/drei\";\nimport { Flex } from \"@react-three/flex\";\nimport { DialogueContext } from \"../VisualDialogue\";\nimport VisualDecision from \"./components/VisualDecision\";\nimport TextInput from \"../components/TextInput\";\nvar FONT_FILE = \"https://d27rt3a60hh1lx.cloudfront.net/fonts/Quicksand_Bold.otf\";\nexport function VisualInteraction(props) {\n  _s();\n\n  var _this = this;\n\n  var effect = props.effect,\n      text = props.text,\n      input = props.input,\n      decisions = props.decisions,\n      enabled = props.enabled;\n\n  var _useContext = useContext(DialogueContext),\n      setKey = _useContext.setKey;\n\n  var _useState = useState(false),\n      prevEnabled = _useState[0],\n      setPrevEnabled = _useState[1];\n\n  var _useSpring = useSpring({\n    posZ: enabled ? 0.003 : -0.003,\n    scaleY: enabled ? 1 : 0\n  }),\n      posZ = _useSpring.posZ,\n      scaleY = _useSpring.scaleY;\n\n  var onSubmit = useMemo(function () {\n    if (!decisions) return function () {\n      return;\n    };\n\n    var _iterator = _createForOfIteratorHelper(decisions),\n        _step;\n\n    try {\n      var _loop = function _loop() {\n        var decision = _step.value;\n\n        if (decision.name === \"submit\") {\n          return {\n            v: function v() {\n              if (decision.onClick) decision.onClick();\n              if (decision.nextKey) setKey(decision.nextKey || \"\");\n            }\n          };\n        }\n      };\n\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var _ret = _loop();\n\n        if (typeof _ret === \"object\") return _ret.v;\n      }\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n  }, [decisions]);\n  useEffect(function () {\n    if (prevEnabled !== enabled) {\n      setPrevEnabled(enabled);\n\n      if (enabled && effect) {\n        effect().then(function (newKey) {\n          if (newKey) {\n            setKey(newKey);\n          }\n        });\n      }\n    }\n  }, [effect, setKey, prevEnabled, enabled]);\n  var textStyles = {\n    font: FONT_FILE,\n    maxWidth: 0.8,\n    textAlign: \"center\",\n    fontSize: 0.06,\n    outlineWidth: 0.0065\n  };\n  return /*#__PURE__*/_jsxDEV(animated.group, {\n    name: \"interaction-\".concat(text.substr(0, 8)),\n    \"position-z\": posZ,\n    \"scale-y\": scaleY,\n    children: [/*#__PURE__*/_jsxDEV(Text, _objectSpread(_objectSpread({}, textStyles), {}, {\n      anchorY: input ? \"bottom\" : \"middle\",\n      \"position-y\": 0,\n      children: text\n    }), void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 7\n    }, this), input && (input.persist || enabled) && /*#__PURE__*/_jsxDEV(TextInput, {\n      value: input.value,\n      setValue: input.setValue,\n      \"position-y\": -0.09,\n      onSubmit: onSubmit,\n      enabled: enabled,\n      inputType: input.type,\n      persist: input.persist\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 9\n    }, this), decisions && /*#__PURE__*/_jsxDEV(Flex, {\n      name: \"decisions\",\n      size: [1, 0.4, 0.1],\n      position: [-0.5, -0.35 / 2, 0.05],\n      justifyContent: \"center\",\n      alignItems: \"flex-start\",\n      flexWrap: \"wrap\",\n      flexDir: \"row\",\n      children: decisions.map(function (decision) {\n        return /*#__PURE__*/_jsxDEV(VisualDecision, _objectSpread({}, decision), decision.name, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 13\n        }, _this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 61,\n    columnNumber: 5\n  }, this);\n}\n\n_s(VisualInteraction, \"ApXz6n8m5eU55LP3yrXF6pTqgBM=\", false, function () {\n  return [useSpring];\n});\n\n_c = VisualInteraction;\n\nvar _c;\n\n$RefreshReg$(_c, \"VisualInteraction\");","map":{"version":3,"sources":["/Users/dub_ceo/Desktop/spacesvr-starter/src/ideas/Builder12/layers/communication/visual/VisualInteraction/index.tsx"],"names":["useContext","useEffect","useMemo","useState","useSpring","animated","Text","Flex","DialogueContext","VisualDecision","TextInput","FONT_FILE","VisualInteraction","props","effect","text","input","decisions","enabled","setKey","prevEnabled","setPrevEnabled","posZ","scaleY","onSubmit","decision","name","onClick","nextKey","then","newKey","textStyles","font","maxWidth","textAlign","fontSize","outlineWidth","substr","persist","value","setValue","type","map"],"mappings":"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","sourcesContent":["import { useContext, useEffect, useMemo, useState } from \"react\";\nimport { useSpring, animated } from \"react-spring/three\";\nimport { Text } from \"@react-three/drei\";\nimport { Flex } from \"@react-three/flex\";\nimport { DialogueContext } from \"../VisualDialogue\";\nimport { Interaction } from \"../../index\";\nimport VisualDecision from \"./components/VisualDecision\";\nimport TextInput from \"../components/TextInput\";\n\nconst FONT_FILE =\n  \"https://d27rt3a60hh1lx.cloudfront.net/fonts/Quicksand_Bold.otf\";\n\nexport function VisualInteraction(props: Interaction & { enabled: boolean }) {\n  const { effect, text, input, decisions, enabled } = props;\n\n  const { setKey } = useContext(DialogueContext);\n  const [prevEnabled, setPrevEnabled] = useState(false);\n\n  const { posZ, scaleY } = useSpring({\n    posZ: enabled ? 0.003 : -0.003,\n    scaleY: enabled ? 1 : 0,\n  });\n\n  const onSubmit = useMemo(() => {\n    if (!decisions)\n      return () => {\n        return;\n      };\n    for (const decision of decisions) {\n      if (decision.name === \"submit\") {\n        return () => {\n          if (decision.onClick) decision.onClick();\n          if (decision.nextKey) setKey(decision.nextKey || \"\");\n        };\n      }\n    }\n  }, [decisions]);\n\n  useEffect(() => {\n    if (prevEnabled !== enabled) {\n      setPrevEnabled(enabled);\n      if (enabled && effect) {\n        effect().then((newKey: string) => {\n          if (newKey) {\n            setKey(newKey);\n          }\n        });\n      }\n    }\n  }, [effect, setKey, prevEnabled, enabled]);\n\n  const textStyles: Partial<typeof Text.defaultProps> = {\n    font: FONT_FILE,\n    maxWidth: 0.8,\n    textAlign: \"center\",\n    fontSize: 0.06,\n    outlineWidth: 0.0065,\n  };\n\n  return (\n    <animated.group\n      name={`interaction-${text.substr(0, 8)}`}\n      position-z={posZ}\n      scale-y={scaleY}\n    >\n      <Text\n        {...textStyles}\n        anchorY={input ? \"bottom\" : \"middle\"}\n        position-y={0}\n      >\n        {text}\n      </Text>\n      {input && (input.persist || enabled) && (\n        <TextInput\n          value={input.value}\n          setValue={input.setValue}\n          position-y={-0.09}\n          onSubmit={onSubmit}\n          enabled={enabled}\n          inputType={input.type}\n          persist={input.persist}\n        />\n      )}\n      {decisions && (\n        <Flex\n          name=\"decisions\"\n          size={[1, 0.4, 0.1]}\n          position={[-0.5, -0.35 / 2, 0.05]}\n          justifyContent=\"center\"\n          alignItems=\"flex-start\"\n          flexWrap=\"wrap\"\n          flexDir=\"row\"\n        >\n          {decisions.map((decision) => (\n            <VisualDecision key={decision.name} {...decision} />\n          ))}\n        </Flex>\n      )}\n    </animated.group>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}