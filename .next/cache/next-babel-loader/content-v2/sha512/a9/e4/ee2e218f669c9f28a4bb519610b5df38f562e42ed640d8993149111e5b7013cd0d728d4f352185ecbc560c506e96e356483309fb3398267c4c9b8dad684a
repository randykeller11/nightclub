{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useFrame } from \"@react-three/fiber\";\nimport { useMemo, useState } from \"react\";\nimport { Vector3 } from \"three\";\nimport { useLimiter } from \"spacesvr\";\nexport var useProximity = function useProximity(group) {\n  _s();\n\n  var dummy = useMemo(function () {\n    return new Vector3();\n  }, []);\n\n  var _useState = useState(\"idle\"),\n      state = _useState[0],\n      setState = _useState[1];\n\n  var limiter = useLimiter(20);\n  useFrame(function (_ref) {\n    var camera = _ref.camera,\n        clock = _ref.clock;\n    if (!group.current || !limiter.isReady(clock)) return;\n    var worldPos = group.current.getWorldPosition(dummy);\n    var dist = camera.position.distanceTo(worldPos);\n    if (dist < 1.75) setState(\"speaking\");else if (dist < 2) setState(\"visible\");else if (dist >= 2) setState(\"idle\");\n  });\n  return {\n    idle: state === \"idle\",\n    visible: state === \"visible\",\n    speaking: state === \"speaking\"\n  };\n};\n\n_s(useProximity, \"T1G4DVeS4/IUXXCVN2wx5Dt6RRg=\", false, function () {\n  return [useLimiter, useFrame];\n});","map":{"version":3,"sources":["/Users/dub_ceo/Desktop/spacesvr-starter/src/ideas/Builder12/utils/proximity.ts"],"names":["useFrame","useMemo","useState","Vector3","useLimiter","useProximity","group","dummy","state","setState","limiter","camera","clock","current","isReady","worldPos","getWorldPosition","dist","position","distanceTo","idle","visible","speaking"],"mappings":";;AAAA,SAASA,QAAT,QAAyB,oBAAzB;AACA,SAAoBC,OAApB,EAA6BC,QAA7B,QAA6C,OAA7C;AACA,SAAgBC,OAAhB,QAA+B,OAA/B;AACA,SAASC,UAAT,QAA2B,UAA3B;AAUA,OAAO,IAAMC,YAAY,GAAG,SAAfA,YAAe,CAC1BC,KAD0B,EAEP;AAAA;;AACnB,MAAMC,KAAK,GAAGN,OAAO,CAAC;AAAA,WAAM,IAAIE,OAAJ,EAAN;AAAA,GAAD,EAAsB,EAAtB,CAArB;;AADmB,kBAGOD,QAAQ,CAAQ,MAAR,CAHf;AAAA,MAGZM,KAHY;AAAA,MAGLC,QAHK;;AAKnB,MAAMC,OAAO,GAAGN,UAAU,CAAC,EAAD,CAA1B;AACAJ,EAAAA,QAAQ,CAAC,gBAAuB;AAAA,QAApBW,MAAoB,QAApBA,MAAoB;AAAA,QAAZC,KAAY,QAAZA,KAAY;AAC9B,QAAI,CAACN,KAAK,CAACO,OAAP,IAAkB,CAACH,OAAO,CAACI,OAAR,CAAgBF,KAAhB,CAAvB,EAA+C;AAE/C,QAAMG,QAAQ,GAAGT,KAAK,CAACO,OAAN,CAAcG,gBAAd,CAA+BT,KAA/B,CAAjB;AACA,QAAMU,IAAI,GAAGN,MAAM,CAACO,QAAP,CAAgBC,UAAhB,CAA2BJ,QAA3B,CAAb;AACA,QAAIE,IAAI,GAAG,IAAX,EAAiBR,QAAQ,CAAC,UAAD,CAAR,CAAjB,KACK,IAAIQ,IAAI,GAAG,CAAX,EAAcR,QAAQ,CAAC,SAAD,CAAR,CAAd,KACA,IAAIQ,IAAI,IAAI,CAAZ,EAAeR,QAAQ,CAAC,MAAD,CAAR;AACrB,GARO,CAAR;AAUA,SAAO;AACLW,IAAAA,IAAI,EAAEZ,KAAK,KAAK,MADX;AAELa,IAAAA,OAAO,EAAEb,KAAK,KAAK,SAFd;AAGLc,IAAAA,QAAQ,EAAEd,KAAK,KAAK;AAHf,GAAP;AAKD,CAvBM;;GAAMH,Y;UAOKD,U,EAChBJ,Q","sourcesContent":["import { useFrame } from \"@react-three/fiber\";\nimport { RefObject, useMemo, useState } from \"react\";\nimport { Group, Vector3 } from \"three\";\nimport { useLimiter } from \"spacesvr\";\n\ntype ProximityState = {\n  idle: boolean;\n  visible: boolean;\n  speaking: boolean;\n};\n\ntype State = \"idle\" | \"visible\" | \"speaking\";\n\nexport const useProximity = (\n  group: RefObject<Group | undefined>\n): ProximityState => {\n  const dummy = useMemo(() => new Vector3(), []);\n\n  const [state, setState] = useState<State>(\"idle\");\n\n  const limiter = useLimiter(20);\n  useFrame(({ camera, clock }) => {\n    if (!group.current || !limiter.isReady(clock)) return;\n\n    const worldPos = group.current.getWorldPosition(dummy);\n    const dist = camera.position.distanceTo(worldPos);\n    if (dist < 1.75) setState(\"speaking\");\n    else if (dist < 2) setState(\"visible\");\n    else if (dist >= 2) setState(\"idle\");\n  });\n\n  return {\n    idle: state === \"idle\",\n    visible: state === \"visible\",\n    speaking: state === \"speaking\",\n  };\n};\n"]},"metadata":{},"sourceType":"module"}