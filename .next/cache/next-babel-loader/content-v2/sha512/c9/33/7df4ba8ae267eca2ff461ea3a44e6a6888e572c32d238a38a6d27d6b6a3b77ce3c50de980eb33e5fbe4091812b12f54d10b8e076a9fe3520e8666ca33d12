{"ast":null,"code":"import _defineProperty from \"/Users/dub_ceo/Desktop/spacesvr-starter/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _objectWithoutProperties from \"/Users/dub_ceo/Desktop/spacesvr-starter/node_modules/next/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\n\nvar _jsxFileName = \"/Users/dub_ceo/Desktop/spacesvr-starter/src/ideas/Builder12/models/Builder2.tsx\",\n    _s = $RefreshSig$(),\n    _this = this;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n/*\nAuto-generated by: https://github.com/pmndrs/gltfjsx\n*/\nimport * as THREE from \"three\";\nimport React, { useCallback, useEffect, useRef, useState } from \"react\";\nimport { useGLTF } from \"@react-three/drei\";\nimport { useFrame, useThree } from \"@react-three/fiber\";\nimport { SkeletonUtils } from \"../utils/SkeletonUtils\";\nvar FILE_URL = \"https://d27rt3a60hh1lx.cloudfront.net/models/SwimmingMort-1627646231/mort.glb.gz\";\nexport default function Model(props) {\n  _s();\n\n  var _props$animation = props.animation,\n      animation = _props$animation === void 0 ? \"idle\" : _props$animation,\n      _props$duration = props.duration,\n      duration = _props$duration === void 0 ? 0.5 : _props$duration,\n      rest = _objectWithoutProperties(props, [\"animation\", \"duration\"]);\n\n  var group = useRef();\n\n  var _ref = useGLTF(FILE_URL),\n      nodes = _ref.nodes,\n      materials = _ref.materials,\n      animations = _ref.animations;\n\n  var scene = useThree(function (state) {\n    return state.scene;\n  });\n\n  var _useState = useState(),\n      armature = _useState[0],\n      setArmature = _useState[1];\n\n  var _useState2 = useState(),\n      rig = _useState2[0],\n      setRig = _useState2[1];\n\n  var _useState3 = useState(),\n      mixer = _useState3[0],\n      setMixer = _useState3[1];\n\n  var actions = useRef();\n  var previousAction = useRef(animation); // function to dispose of loaded dummy\n\n  var disposeDummy = useCallback(function () {\n    if (armature) {\n      armature.traverse(function (obj) {\n        return scene.remove(obj);\n      });\n      setArmature(undefined);\n      setRig(undefined);\n    }\n  }, [armature]);\n\n  var fadeToAction = function fadeToAction(name) {\n    var duration = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0.2;\n    var acts = actions === null || actions === void 0 ? void 0 : actions.current;\n    if (!acts) return;\n    if (name === previousAction.current) return;\n\n    if (acts[previousAction.current].enabled) {\n      acts[previousAction.current].fadeOut(duration);\n    }\n\n    acts[name].reset().setEffectiveTimeScale(1).setEffectiveWeight(1).fadeIn(duration).play();\n    previousAction.current = name;\n  };\n\n  useEffect(function () {\n    if (!armature) {\n      // create new armature\n      var newArmature = SkeletonUtils.clone(nodes.Armature); //create new mixer\n\n      var _avatar = getArmatureChild(newArmature, \"avatar\");\n\n      var newMixer = new THREE.AnimationMixer(_avatar); // store the rig in state because when it is added to the scene\n      // the armature loses the child\n\n      var locRig = getArmatureChild(newArmature, \"rig\");\n      setRig(locRig); // see meshes up close, need this shit bruv\n\n      newArmature.traverse(function (obj) {\n        return obj.frustumCulled = false;\n      }); // load all actions and play selected one\n      // @ts-ignore\n\n      actions.current = animations.reduce(function (acc, cur) {\n        var name = cur.name; // @ts-ignore\n\n        acc[name] = newMixer.clipAction(cur, group.current);\n        return acc;\n      }, {}); // play the current animation\n      // @ts-ignore\n\n      actions.current[animation].play(); // store into state\n\n      setArmature(newArmature);\n      setMixer(newMixer);\n      return function () {\n        disposeDummy();\n      };\n    }\n  }, [armature]);\n  useEffect(function () {\n    if (!armature || !actions.current) return;\n    fadeToAction(animation, duration);\n  }, [animation, armature, actions]); // update animation every frame\n\n  useFrame(function (_, delta) {\n    return mixer && mixer.update(delta);\n  });\n\n  if (!armature) {\n    return null;\n  } // get armature mesh children\n\n\n  var avatar = getArmatureChild(armature, \"avatar\");\n  return /*#__PURE__*/_jsxDEV(\"group\", _objectSpread(_objectSpread({\n    ref: group\n  }, rest), {}, {\n    dispose: null,\n    \"rotation-y\": 0,\n    children: /*#__PURE__*/_jsxDEV(\"group\", {\n      name: \"Armature\",\n      \"rotation-x\": Math.PI / 2,\n      scale: 0.00615,\n      \"position-y\": 0,\n      frustumCulled: false,\n      children: [rig && /*#__PURE__*/_jsxDEV(\"primitive\", {\n        object: rig\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 17\n      }, this), getSkinnedMesh(avatar, materials[\"avatar.mat\"])]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 7\n    }, this)\n  }), void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 132,\n    columnNumber: 5\n  }, this);\n} // helper, create explicit skinnedMesh object as react component\n\n_s(Model, \"ne9y0NdxLBqZxEAsJLKXDT1NXAk=\", false, function () {\n  return [useGLTF, useThree, useFrame];\n});\n\n_c = Model;\n\nvar getSkinnedMesh = function getSkinnedMesh(object, material) {\n  return /*#__PURE__*/_jsxDEV(\"skinnedMesh\", {\n    material: material,\n    geometry: object.geometry,\n    skeleton: object.skeleton,\n    frustumCulled: false\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 150,\n    columnNumber: 5\n  }, _this);\n}; // helper, get one of children from the armature, returns undefined if not found\n\n\nvar getArmatureChild = function getArmatureChild(armature, id) {\n  switch (id) {\n    case \"avatar\":\n      return armature.children.find(function (ch) {\n        return ch.name === \"avatar\";\n      });\n\n    case \"rig\":\n      return armature.children.find(function (ch) {\n        return ch.name === \"mixamorigHips\";\n      });\n  }\n\n  return undefined;\n};\n\nuseGLTF.preload(FILE_URL);\n\nvar _c;\n\n$RefreshReg$(_c, \"Model\");","map":{"version":3,"sources":["/Users/dub_ceo/Desktop/spacesvr-starter/src/ideas/Builder12/models/Builder2.tsx"],"names":["THREE","React","useCallback","useEffect","useRef","useState","useGLTF","useFrame","useThree","SkeletonUtils","FILE_URL","Model","props","animation","duration","rest","group","nodes","materials","animations","scene","state","armature","setArmature","rig","setRig","mixer","setMixer","actions","previousAction","disposeDummy","traverse","obj","remove","undefined","fadeToAction","name","acts","current","enabled","fadeOut","reset","setEffectiveTimeScale","setEffectiveWeight","fadeIn","play","newArmature","clone","Armature","avatar","getArmatureChild","newMixer","AnimationMixer","locRig","frustumCulled","reduce","acc","cur","clipAction","_","delta","update","Math","PI","getSkinnedMesh","object","material","geometry","skeleton","id","children","find","ch","preload"],"mappings":"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","sourcesContent":["/*\nAuto-generated by: https://github.com/pmndrs/gltfjsx\n*/\n\nimport * as THREE from \"three\";\nimport React, { useCallback, useEffect, useRef, useState } from \"react\";\nimport { useGLTF } from \"@react-three/drei\";\nimport { GLTF } from \"three/examples/jsm/loaders/GLTFLoader\";\nimport { GroupProps, useFrame, useThree } from \"@react-three/fiber\";\nimport { AnimationMixer, Bone, Object3D, SkinnedMesh } from \"three\";\nimport { SkeletonUtils } from \"../utils/SkeletonUtils\";\n\ntype GLTFResult = GLTF & {\n  nodes: {\n    avatar: THREE.SkinnedMesh;\n    mixamorigHips: THREE.Bone;\n    Armature: Object3D;\n  };\n  materials: {\n    [\"avatar.mat\"]: THREE.MeshStandardMaterial;\n  };\n};\n\ntype ActionName = \"swimmin\" | \"idle\" | \"lay\" | \"wave\";\ntype GLTFActions = Record<ActionName, THREE.AnimationAction>;\n\nconst FILE_URL =\n  \"https://d27rt3a60hh1lx.cloudfront.net/models/SwimmingMort-1627646231/mort.glb.gz\";\n\ntype ModelProps = {\n  animation?: ActionName;\n  duration?: number;\n} & GroupProps;\n\nexport default function Model(props: ModelProps) {\n  const { animation = \"idle\", duration = 0.5, ...rest } = props;\n\n  const group = useRef<THREE.Group>();\n  const { nodes, materials, animations } = useGLTF(FILE_URL) as GLTFResult;\n\n  const scene = useThree((state) => state.scene);\n  const [armature, setArmature] = useState<Object3D | undefined>();\n  const [rig, setRig] = useState<Bone>();\n  const [mixer, setMixer] = useState<AnimationMixer | undefined>();\n  const actions = useRef<GLTFActions>();\n  const previousAction = useRef(animation);\n\n  // function to dispose of loaded dummy\n  const disposeDummy = useCallback(() => {\n    if (armature) {\n      armature.traverse((obj) => scene.remove(obj));\n      setArmature(undefined);\n      setRig(undefined);\n    }\n  }, [armature]);\n\n  const fadeToAction = (name: ActionName, duration = 0.2) => {\n    const acts = actions?.current;\n    if (!acts) return;\n    if (name === previousAction.current) return;\n\n    if (acts[previousAction.current].enabled) {\n      acts[previousAction.current].fadeOut(duration);\n    }\n\n    acts[name]\n      .reset()\n      .setEffectiveTimeScale(1)\n      .setEffectiveWeight(1)\n      .fadeIn(duration)\n      .play();\n\n    previousAction.current = name;\n  };\n\n  useEffect(() => {\n    if (!armature) {\n      // create new armature\n      const newArmature = SkeletonUtils.clone(nodes.Armature) as Object3D;\n\n      //create new mixer\n      const avatar = getArmatureChild(newArmature, \"avatar\") as SkinnedMesh;\n      const newMixer = new THREE.AnimationMixer(avatar);\n\n      // store the rig in state because when it is added to the scene\n      // the armature loses the child\n      const locRig = getArmatureChild(newArmature, \"rig\") as Bone;\n      setRig(locRig);\n\n      // see meshes up close, need this shit bruv\n      newArmature.traverse((obj) => (obj.frustumCulled = false));\n\n      // load all actions and play selected one\n      // @ts-ignore\n      actions.current = animations.reduce((acc, cur) => {\n        const name = cur.name as ActionName;\n        // @ts-ignore\n        acc[name] = newMixer.clipAction(cur, group.current);\n        return acc;\n      }, {});\n\n      // play the current animation\n      // @ts-ignore\n      actions.current[animation].play();\n\n      // store into state\n      setArmature(newArmature);\n      setMixer(newMixer);\n\n      return () => {\n        disposeDummy();\n      };\n    }\n  }, [armature]);\n\n  useEffect(() => {\n    if (!armature || !actions.current) return;\n    fadeToAction(animation, duration);\n  }, [animation, armature, actions]);\n\n  // update animation every frame\n  useFrame((_, delta) => mixer && mixer.update(delta));\n\n  if (!armature) {\n    return null;\n  }\n\n  // get armature mesh children\n  const avatar = getArmatureChild(armature, \"avatar\") as SkinnedMesh;\n\n  return (\n    <group ref={group} {...rest} dispose={null} rotation-y={0}>\n      <group\n        name=\"Armature\"\n        rotation-x={Math.PI / 2}\n        scale={0.00615}\n        position-y={0}\n        frustumCulled={false}\n      >\n        {rig && <primitive object={rig} />}\n        {getSkinnedMesh(avatar, materials[\"avatar.mat\"])}\n      </group>\n    </group>\n  );\n}\n\n// helper, create explicit skinnedMesh object as react component\nconst getSkinnedMesh = (object: SkinnedMesh, material: THREE.Material) => {\n  return (\n    <skinnedMesh\n      material={material}\n      geometry={object.geometry}\n      skeleton={object.skeleton}\n      frustumCulled={false}\n    />\n  );\n};\n\n// helper, get one of children from the armature, returns undefined if not found\nconst getArmatureChild = (armature: Object3D, id: \"avatar\" | \"rig\") => {\n  switch (id) {\n    case \"avatar\":\n      return armature.children.find((ch) => ch.name === \"avatar\");\n    case \"rig\":\n      return armature.children.find((ch) => ch.name === \"mixamorigHips\");\n  }\n\n  return undefined;\n};\n\nuseGLTF.preload(FILE_URL);\n"]},"metadata":{},"sourceType":"module"}